/*!
 * ResponsiveGauge
 * version : 0.1.0
 * license : MIT
 * authors : MikaÃ«l Restoux, Matt Magoffin (http://bl.ocks.org/msqr/3202712)
 * 
 */
var ResponsiveGaugeFactory=function(t,e){"use strict";"undefined"==typeof d3&&(d3=t),"undefined"==typeof numbro&&(numbro=e);var r=".gauge-container{display:inline-block;position:relative}.gauge-container .gauge{position:absolute;top:0;left:0}.gauge-ie-fix{display:block;height:100%;width:100%;visibility:hidden}.gauge{display:inline-block;overflow:visible;height:100%;max-width:100%}.gauge-needle{stroke:#cf4814;fill:transparent}.gauge-filament{stroke:#000}.gauge-filler{fill:#d50000}.gauge-arc{fill:#ddd}.gauge-arc-border{stroke:#000;stroke-width:.3px}.gauge text{fill:#333}.gauge-label text{text-anchor:middle;font-weight:700;font-size:4px}.wide-gauge .gauge-label text{font-size:8px}.gauge-label g:first-child text{text-anchor:start}.gauge-label g:last-child text{text-anchor:end}.gauge-value text{font-size:12px;text-anchor:middle}.wide-gauge .gauge-value text{font-size:24px}.unit{font-size:.7em}",n=6,a=2,i=100,o=40,l=numbro(),s=function(t,e){function r(t,e){0===t.decimalsMax?this[e]=t.mantissaMax+".a":this[e]=t.mantissaMax+".["+new Array(t.decimalsMax+1).join("0")+"]a"}var n,a;return e?(n="LABEL_FORMAT",a=this.labels,void 0===this.LABEL_FORMAT&&r.call(this,a,n)):(n="VALUE_FORMAT",a=this.value,void 0===this.VALUE_FORMAT&&r.call(this,a,n)),l.set(t).format(this[n])},u={ring:{shift:3,width:7,minAngle:-90,maxAngle:90,sectorsNumber:5,border:!1,colors:!1,startColor:"#ffebee",endColor:"#810301"},pointer:{type:"needle",slowness:200,needleLength:90,filamentLength:2,fillerWidth:null,fillerShift:0},data:{min:0,max:100,value:0},labels:{number:null,formatter:function(t){return s.call(this,t,!0)},mantissaMax:4,decimalsMax:0,shift:0},value:{show:!0,shift:22,formatter:function(t){return s.call(this,t,!1)},mantissaMax:4,decimalsMax:0,unit:""}},d=function(t,e){function r(t){return t*Math.PI/180}function l(){if(null===_.labels.number&&(_.labels.number=_.ring.sectorsNumber),0===_.labels.number)return[];var t=(_.data.max-_.data.min)/(_.labels.number-1),e=d3.range(_.data.min,_.data.max,t);return e.push(_.data.max),e}function s(t,e,r){for(var n in e)if(e.hasOwnProperty(n)){var a=e[n];"object"==typeof a&&a.constructor!==Array?(void 0===t[n]&&(t[n]={}),s(t[n],a,r[n])):(t[n]=a,void 0===r[n]&&console.warn("Config property "+n+" is unknwon"))}}function f(t){_=JSON.parse(JSON.stringify(u)),_.labels.formatter=u.labels.formatter,_.value.formatter=u.value.formatter,s(_,t,u),_.FORMAT=void 0,_.labels.formatter=_.labels.formatter.bind(_),_.value.formatter=_.value.formatter.bind(_)}function c(t){f(t),y=_.ring.maxAngle-_.ring.minAngle,p(),w=d3.scale.linear().range([0,1]).domain([_.data.min,_.data.max]),T=l(),_.ring.colors.constructor===Array?(E=d3.range(_.ring.sectorsNumber).map(function(){return 1/_.ring.sectorsNumber}),F=function(t){var e=Math.floor(t*_.ring.sectorsNumber);return e=Math.min(e,_.ring.colors.length-1),_.ring.colors[e]}):_.ring.colors?(E="gradient"===_.ring.colors?d3.range(o).map(function(){return 1/o}):d3.range(_.ring.sectorsNumber).map(function(){return 1/_.ring.sectorsNumber}),F=d3.interpolateHsl(d3.rgb(_.ring.startColor),d3.rgb(_.ring.endColor))):E=[1],O=g(function(t,e){var n=t*e,a=0===e?0:.5;return r(_.ring.minAngle+n*y-a)},function(t,e){var n=t*(e+1);return r(_.ring.minAngle+n*y)},_.ring.width,_.ring.shift),_.ring.border&&(j=g(r(_.ring.minAngle),r(_.ring.maxAngle),_.ring.width,_.ring.shift)),"filler"===_.pointer.type&&null===_.pointer.fillerWidth&&(_.pointer.fillerWidth=_.ring.width,_.pointer.fillerShift=_.ring.shift)}function g(t,e,r,n){return d3.svg.arc().innerRadius(q-r-n).outerRadius(q-n).startAngle(t).endAngle(e)}function m(){var t=JSON.parse(JSON.stringify(_));return Object.freeze(t),t}function p(){function t(t){return[e(a+t),e(i+t)]}function e(t){return o*Math.sin(r(t))}for(var a=_.ring.minAngle,i=_.ring.maxAngle,o=q-Math.min(_.ring.shift,_.pointer.fillerShift,_.labels.shift),l=0,s=0,u=0,d=0,f=Math.floor(a/90),c=Math.floor(i/90),g=f;c>=g;g++)switch(g%4){case 0:u=o;break;case 1:s=o;break;case 2:d=o;break;case 3:l=o}var m=t(0),p=t(-90);l=Math.abs(Math.min(-l,m[0],m[1])),s=Math.max(s,m[0],m[1]),u=Math.abs(Math.min(-u,p[0],p[1])),d=Math.max(d,p[0],p[1]),k=l+s+2*n,B=u+d+2*n;var h=u+n,v=l+n,b=3*o+4*n;B+k>b&&(G=!0,k+=2*n,B+=2*n,h+=n,v+=n),C="translate("+v+","+h+")"}function h(t){c(t),v();var e=R.append("g").attr("class","gauge-arc").attr("transform",C),r=e.selectAll("path").data(E).enter().append("path").attr("d",O);_.ring.colors&&r.attr("fill",function(t,e){return F(t*e)}),_.ring.border&&e.append("path").attr("fill","none").attr("class","gauge-arc-border").attr("d",j);var n=d3.svg.line().interpolate("monotone"),i=R.append("g").attr("class","gauge-pointer gauge-"+_.pointer.type).attr("transform",C);if("filler"===_.pointer.type)N=i.append("path");else if("needle"===_.pointer.type)N=i.data([[[0,-a],[0,-_.pointer.needleLength/2]]]).append("path").attr("d",n),i.append("circle").attr("r",a);else if("filament"===_.pointer.type){var o=q-_.ring.shift-_.ring.width-_.pointer.filamentLength,l=q-_.ring.shift+_.pointer.filamentLength;N=i.data([[[0,-o],[0,-l]]]).append("path").attr("d",n)}R.append("g").attr("class","gauge-label").attr("transform",C).selectAll("text").data(T).enter().append("g").attr("transform",function(t){var e=w(t),r=_.ring.minAngle+e*y;return"rotate("+r+") translate(0,"+(_.labels.shift-q)+")"}).append("text").text(_.labels.formatter);if(_.value.show){var s=_.value.shift,u=_.ring.minAngle+Math.abs(y)/2;G&&(s=0,u=0);var d="translate(0, "+-s+")",f=R.append("g").attr("class","gauge-value").attr("transform",C+" rotate("+u+")").append("g").attr("transform",d+" rotate("+-u+")").append("text");L=f.append("tspan").attr("dy","0.4em"),f.append("tspan").text(_.value.unit).attr("class","unit").attr("x",0).attr("dy","1em")}}function v(){S=d3.select(t),window.navigator.userAgent.match(/(MSIE|Trident|Edge)/)&&(S.classed("gauge-container",!0),S.append("canvas").attr({"class":"gauge-ie-fix",width:k,height:B}),b()),R=S.classed("wide-gauge",G).append("svg:svg").attr("class","gauge").attr("viewBox","0 0 "+k+" "+B).attr("preserveAspectRatio","xMinYMin meet")}function b(){function t(t,e){var r=null;return function(){clearTimeout(r),r=setTimeout(function(){t()},e)}}d.ieListenerSet||(window.addEventListener("resize",t(function(){for(var t=document.querySelectorAll("canvas"),e=0;e<t.length;++e){var r=t[e];r.setAttribute("height",r.getAttribute("height"))}},250)),d.ieListenerSet=!0)}function x(t){if("filler"===_.pointer.type){var e=g(r(_.ring.minAngle),r(A(t)),_.pointer.fillerWidth,_.pointer.fillerShift);N.attr("d",e)}else N.transition().duration(_.pointer.slowness).ease("elastic").attr("transform","rotate("+A(t)+")")}function A(t){var e=Math.max(t,_.data.min);e=Math.min(e,_.data.max);var r=w(e);return _.ring.minAngle+r*y}function M(t,e){t=void 0===t?0:t,x(t),_.value.show&&L.text(_.value.formatter(t))}var y,w,L,S,R,N,O,j,T,E,F,C,_={},q=i/2,G=!1,k=0,B=0;return h(e),M(_.data.value),{update:M,getConfig:m,container:S}};d.config=u;var f=document.createElement("style");if(f.type="text/css",f.innerHTML=r,document.getElementsByTagName("head")[0].appendChild(f),"undefined"!=typeof module&&module.exports)module.exports=d;else{if("undefined"!=typeof requirejs)return d;this.ResponsiveGauge=d}};if("undefined"!=typeof module&&module.exports){var _d3=require("d3"),_numbro=require("numbro");ResponsiveGaugeFactory(_d3,_numbro)}else if("undefined"!=typeof requirejs){var protocol=document.location.protocol;protocol="file:"===protocol?"http:":protocol,requirejs.config({paths:{d3:protocol+"//cdn.jsdelivr.net/d3js/3.5.16/d3.min",numbro:protocol+"//cdnjs.cloudflare.com/ajax/libs/numbro/1.7.1/numbro.min"}}),define(["d3","numbro"],function(t,e){return ResponsiveGaugeFactory(t,e)})}else ResponsiveGaugeFactory.call("undefined"==typeof window?this:window);